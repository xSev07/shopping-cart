!function(e){function t(t){for(var r,c,s=t[0],i=t[1],l=t[2],d=0,m=[];d<s.length;d++)c=s[d],Object.prototype.hasOwnProperty.call(n,c)&&n[c]&&m.push(n[c][0]),n[c]=0;for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r]);for(u&&u(t);m.length;)m.shift()();return o.push.apply(o,l||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],r=!0,s=1;s<a.length;s++){var i=a[s];0!==n[i]&&(r=!1)}r&&(o.splice(t--,1),e=c(c.s=a[0]))}return e}var r={},n={0:0},o=[];function c(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,c),a.l=!0,a.exports}c.m=e,c.c=r,c.d=function(e,t,a){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},c.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(c.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)c.d(a,r,function(t){return e[t]}.bind(null,r));return a},c.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="./";var s=window.webpackJsonp=window.webpackJsonp||[],i=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=i;o.push([51,1]),a()}({22:function(e,t,a){var r=a(23),n=a(24);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var o={insert:"head",singleton:!1};r(n,o);e.exports=n.locals||{}},24:function(e,t,a){},51:function(e,t,a){"use strict";a.r(t);a(22);var r=a(0),n=a.n(r),o=a(4),c=a.n(o),s=a(1),i=a.n(s);const l=Object(r.forwardRef)((e,t)=>{const{className:a,startCount:o=1,onChange:c}=e,[s,i]=Object(r.useState)(o);Object(r.useEffect)(()=>{c&&c(s)},[s]),Object(r.useEffect)(()=>{s!==o&&i(o)},[o]);return n.a.createElement("div",{className:"cart-count "+a},n.a.createElement("button",{onClick:()=>{s>1&&i(e=>e-1)},className:"cart-count__button",type:"button"},"-"),n.a.createElement("input",{onChange:e=>{const t=+e.target.value;i(t>0?t:1)},ref:t,type:"number",className:"cart-count__value",value:s,min:"1","aria-label":"Количество"}),n.a.createElement("button",{onClick:()=>{i(e=>e+1)},className:"cart-count__button",type:"button"},"+"))});l.displayName="Counter",l.propTypes={className:i.a.string.isRequired,startCount:i.a.number,onChange:i.a.func};var u=l;const d=e=>{const{goods:t,onDeleteButtonClick:a,onCounterChange:o}=e,{id:c,name:s,price:i,count:l,picture:d}=t,m=Object(r.useRef)(null),p=1===l?i:i*l;return n.a.createElement("li",{className:"cart__item"},n.a.createElement("img",{src:d,alt:s,className:"cart__picture",width:"100",height:"100"}),n.a.createElement("div",{className:"cart__info"},n.a.createElement("div",{className:"cart__row cart-row"},n.a.createElement("h3",{className:"cart__title"},n.a.createElement("a",{href:"#",className:"cart__link"},s)),n.a.createElement("div",{className:"cart__price-wrapper"},n.a.createElement("p",{className:"cart__price-total"},p.toLocaleString()," ₽"),l>1&&n.a.createElement("p",{className:"cart__price"},l.toLocaleString()," x ",i.toLocaleString()," ₽"))),n.a.createElement("div",{className:"cart__row cart-row"},n.a.createElement("button",{onClick:()=>a(c),className:"cart__delete cart-button  cart-button--in-text",type:"button"},"Удалить"),n.a.createElement(u,{ref:m,className:"cart__count-wrapper cart-row",startCount:l,onChange:e=>o(c,e)}))))};d.propTypes={goods:i.a.arrayOf(i.a.shape({id:i.a.string.isRequired,name:i.a.string.isRequired,price:i.a.number.isRequired,picture:i.a.string.isRequired,count:i.a.number.isRequired})).isRequired,onDeleteButtonClick:i.a.func.isRequired,onCounterChange:i.a.func.isRequired};var m=d;const p=e=>{const{allGoods:t,onFormSubmit:a}=e,o=Object(r.useRef)(null),c=Object(r.useRef)(null);return n.a.createElement("section",{className:"cart-addition container"},n.a.createElement("h2",{className:"cart-addition__title"},"Добавить товар"),n.a.createElement("form",{onSubmit:e=>{e.preventDefault(),a(c.current.value,+o.current.value)},action:"#",className:"cart-addition__form"},n.a.createElement("select",{ref:c,className:"cart-addition__select","aria-label":"Выбрать товар из списка"},t.map(e=>n.a.createElement("option",{key:e.id,value:e.id},e.name))),n.a.createElement(u,{ref:o,className:"cart-addition__count-wrapper"}),n.a.createElement("button",{className:"cart-addition__add cart-button cart-button--attention",type:"submit"},"Добавить")))};p.propTypes={allGoods:i.a.arrayOf(i.a.shape({id:i.a.string.isRequired,name:i.a.string.isRequired,price:i.a.number.isRequired,picture:i.a.string.isRequired})).isRequired,onFormSubmit:i.a.func.isRequired};var f=p,_=a(5);const b=(...e)=>Object.assign({},...e),E={allGoods:[],selectedGoods:[]},g={LOAD_GOODS:"LOAD_GOODS",CHANGE_SELECTED_GOODS:"CHANGE_SELECTED_GOODS"},O=e=>({type:g.LOAD_GOODS,payload:e}),G=e=>({type:g.CHANGE_SELECTED_GOODS,payload:e}),h=()=>(e,t,a)=>a.get("/goods").then(t=>e(O(t.data.map(e=>(e=>({id:e.id,name:e.name,price:e.price,picture:e.picture}))(e))))),y=(e=E,t)=>{switch(t.type){case g.LOAD_GOODS:return b(e,{allGoods:t.payload});case g.CHANGE_SELECTED_GOODS:return b(e,{selectedGoods:t.payload})}return e},v={GOODS:["товар","товара","товаров"]},N=e=>{const{allGoods:t,selectedGoods:a,countGoods:r,totalGoods:o,addGoods:c,deleteGoods:s,changeGoodsCount:i,onFormSubmit:l}=e,u=((e,t)=>{const a=(e=Math.abs(e)%100)%10;return e>10&&e<20?t[2]:a>1&&a<5?t[1]:1===a?t[0]:t[2]})(r,v.GOODS);return n.a.createElement(n.a.Fragment,null,n.a.createElement(f,{allGoods:t,onFormSubmit:c}),n.a.createElement("section",{className:"cart container"},n.a.createElement("h2",{className:"visually-hidden"},"Товары в корзине"),n.a.createElement("form",{className:"cart__form",onSubmit:l},n.a.createElement("ul",{className:"cart__list"},a.map(e=>n.a.createElement(m,{key:e.id,goods:e,onDeleteButtonClick:s,onCounterChange:i}))),n.a.createElement("div",{className:"cart__total"},n.a.createElement("div",{className:"cart__row cart__total-row cart-row"},n.a.createElement("p",{className:"cart__total-count"},"В корзине ",r.toLocaleString()," ",u),n.a.createElement("p",{className:"cart__total-price"},o.toLocaleString()," ₽")),n.a.createElement("button",{className:"cart__submit cart-button cart-button--attention",type:"submit",disabled:0===r},"Продолжить оформление")))))};N.propTypes={allGoods:i.a.arrayOf(i.a.shape({id:i.a.string.isRequired,name:i.a.string.isRequired,price:i.a.number.isRequired,picture:i.a.string.isRequired})).isRequired,selectedGoods:i.a.arrayOf(i.a.shape({id:i.a.string.isRequired,name:i.a.string.isRequired,price:i.a.number.isRequired,picture:i.a.string.isRequired,count:i.a.number.isRequired})).isRequired,countGoods:i.a.number.isRequired,totalGoods:i.a.number.isRequired,addGoods:i.a.func.isRequired,deleteGoods:i.a.func.isRequired,changeGoodsCount:i.a.func.isRequired,onFormSubmit:i.a.func.isRequired};var R=Object(_.b)(e=>({allGoods:e.allGoods,selectedGoods:e.selectedGoods,countGoods:e.selectedGoods.reduce((e,t)=>e+t.count,0),totalGoods:e.selectedGoods.reduce((e,t)=>e+t.price*t.count,0)}),null,(e,t,a)=>{const{allGoods:r,selectedGoods:n}=e,{dispatch:o}=t,c=n.slice().reverse();return b(e,t,a,{selectedGoods:c,addGoods:(e,t)=>{let a=[];const c=n.findIndex(t=>t.id===e);if(-1===c){const o=r.find(t=>t.id===e);a=n.slice(),a.push((i=t,{id:(s=o).id,name:s.name,price:s.price,picture:s.picture,count:i}))}else{const e=n[c],r=b(e,{count:e.count+t});a=[...n.slice(0,c),r,...n.slice(c+1)]}var s,i;o(G(a))},deleteGoods:e=>{const t=n.findIndex(t=>t.id===e),a=[...n.slice(0,t),...n.slice(t+1)];o(G(a))},changeGoodsCount:(e,t)=>{const a=n.findIndex(t=>t.id===e),r=b(n[a],{count:t}),c=[...n.slice(0,a),r,...n.slice(a+1)];o(G(c))}})})(N),S=a(19),q=a.n(S);var C=a(3),w=a(20),D=a(21);(()=>{const e=(()=>{const e=q.a.create({baseURL:"http://zjdog.mocklab.io",timeout:5e3});return e.interceptors.response.use(e=>e,e=>{throw e}),e})(),t=Object(C.createStore)(y,Object(w.composeWithDevTools)(Object(C.applyMiddleware)(D.a.withExtraArgument(e))));t.dispatch(h()),c.a.render(n.a.createElement(_.a,{store:t},n.a.createElement(R,{onFormSubmit:()=>{}})),document.querySelector("#root"))})()}});